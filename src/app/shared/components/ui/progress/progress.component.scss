@use "sass:math";
@use "../../../../../styles/abstracts/variables" as *;
@use "../../../../../styles/abstracts/mixins" as *;

.av-progress {
  display: inline-block;
  width: 100%;
  font-size: $font-size-base;
  line-height: 1.5;
  color: $color-text-primary;
  box-sizing: border-box;
  margin: 0;
  padding: 0;
  list-style: none;

  // === LINE TYPE ===
  &--line {
    position: relative;
    width: 100%;

    .av-progress-outer {
      display: inline-block;
      width: 100%;
      margin-right: 0;
      padding-right: 0;

      &--with-info {
        padding-right: calc(2em + 8px);
        margin-right: calc(-2em - 8px);
      }
    }

    .av-progress-inner {
      position: relative;
      display: inline-block;
      width: 100%;
      overflow: hidden;
      vertical-align: middle;
      background-color: var(--av-progress-trail-color, #f5f5f5);
      border-radius: 100px;
    }

    .av-progress-bg {
      position: relative;
      background-color: var(--av-progress-color, #1677ff);
      border-radius: 100px;
      transition: all 0.3s cubic-bezier(0.78, 0.14, 0.15, 0.86);
    }

    .av-progress-info {
      position: absolute;
      right: 0;
      top: 50%;
      transform: translateY(-50%);
      display: inline-block;
      padding-left: 8px;
      color: $color-text-secondary;
      white-space: nowrap;
      vertical-align: middle;
    }
  }

  // === CIRCLE & DASHBOARD TYPE ===
  &--circle,
  &--dashboard {
    position: relative;
    display: inline-block;

    .av-progress-inner {
      position: relative;
      line-height: 1;
      background-color: transparent;
    }

    .av-progress-info {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 100%;
      margin: 0;
      padding: 0;
      color: $color-text-primary;
      line-height: $line-height-base;
      white-space: normal;
      text-align: center;
      transform: translate(-50%, -50%);
    }

    .av-progress-circle-path {
      stroke: $color-primary;
    }

    svg {
      transition: all 0.3s;
    }
  }

  // === STATUSES ===
  &--status-success {
    .av-progress-bg,
    .av-progress-circle-path {
      stroke: $color-success;
      background-color: $color-success;
    }
    .av-progress-info {
      color: $color-success;
    }
  }

  &--status-error {
    .av-progress-bg,
    .av-progress-circle-path {
      stroke: $color-error;
      background-color: $color-error;
    }
    .av-progress-info {
      color: $color-error;
    }
  }

  &--status-warning {
    .av-progress-bg,
    .av-progress-circle-path {
      stroke: $color-warning;
      background-color: $color-warning;
    }
    .av-progress-info {
      color: $color-warning;
    }
  }

  &--status-active {
    .av-progress-bg,
    .av-progress-circle-path {
      stroke: $color-primary;
    }
    .av-progress-bg::before {
      content: "";
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      background: $color-white;
      border-radius: 10px;
      opacity: 0;
      animation: av-progress-active 2.4s cubic-bezier(0.23, 1, 0.32, 1) infinite;
    }
  }

  // === INDETERMINATE ===
  &--indeterminate {
    .av-progress-bg {
      width: 100% !important;
      animation: av-progress-indeterminate 2.4s cubic-bezier(0.23, 1, 0.32, 1) infinite;
    }
  }

  // === ANIMATIONS ===
  @keyframes av-progress-active {
    0% {
      transform: translateX(-100%) scaleX(0);
      opacity: 0.1;
    }
    20% {
      transform: translateX(-100%) scaleX(0);
      opacity: 0.5;
    }
    100% {
      transform: translateX(0) scaleX(1);
      opacity: 0;
    }
  }

  @keyframes av-progress-indeterminate {
    0% {
      transform: translateX(-100%) scaleX(0.2);
    }
    50% {
      transform: translateX(0) scaleX(0.5);
    }
    100% {
      transform: translateX(100%) scaleX(0.2);
    }
  }

  // === DARK THEME ===
  @include dark-theme {
    .av-progress-inner {
      background-color: #262626;
    }
    .av-progress-circle-trail {
      stroke: #262626;
    }
    .av-progress-info {
      color: $dark-text-secondary;
    }
    &--status-success .av-progress-info {
      color: $dark-success;
    }
    &--status-error .av-progress-info {
      color: $dark-error;
    }
    &--status-warning .av-progress-info {
      color: $dark-warning;
    }
  }
}
