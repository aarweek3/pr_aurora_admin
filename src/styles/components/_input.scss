// src/styles/components/_input.scss
// ============================================================================
// Input Component Styles
// ============================================================================
// Стили для input элементов с поддержкой размеров, статусов и вариантов
// Использует BEM нотацию и CSS переменные
// ============================================================================

@use "sass:color";
@use "../abstracts/variables" as *;
@use "../abstracts/mixins" as *;

// ============================================================================
// Base Input Styles
// ============================================================================

.av-input {
  width: 100%;
  height: 32px;
  padding: 4px 12px;
  font-size: $font-size-base;
  line-height: 1.5;
  color: $color-text-primary;
  background-color: $color-white;
  background-image: none;
  border: 1px solid $color-border-base;
  border-radius: $border-radius-base;
  transition: all $transition-base;
  outline: none;
  box-sizing: border-box;

  // Placeholder
  &::placeholder {
    color: $color-text-tertiary;
    opacity: 1;
  }

  // Focus state
  &:focus {
    border-color: $color-primary;
    outline: none;
  }

  // Hover state
  &:hover:not(:disabled):not(:focus) {
    border-color: $color-primary-hover;
  }

  // Disabled state
  &:disabled,
  &--disabled {
    background-color: $color-bg-light;
    border-color: $color-border-base;
    color: $color-text-disabled;
    cursor: not-allowed;
    opacity: 0.6;

    &::placeholder {
      color: $color-text-disabled;
    }
  }

  // Readonly state
  &:read-only {
    background-color: $color-bg-light;
    cursor: default;
  }

  // ============================================================================
  // Sizes
  // ============================================================================

  &--small {
    height: 24px;
    padding: 2px 8px;
    font-size: $font-size-sm;
  }

  &--large {
    height: 40px;
    padding: 8px 16px;
    font-size: $font-size-lg;
  }

  &--x-large {
    height: 48px;
    padding: 12px 20px;
    font-size: $font-size-lg;
  }

  // ============================================================================
  // Status (Validation)
  // ============================================================================

  &--error {
    border-color: $color-error;

    &:focus {
      border-color: $color-error;
      outline: none;
    }

    &:hover:not(:disabled) {
      border-color: $color-error-hover;
    }
  }

  &--warning {
    border-color: $color-warning;

    &:focus {
      border-color: $color-warning;
      outline: none;
    }

    &:hover:not(:disabled) {
      border-color: $color-warning-hover;
    }
  }

  &--success {
    border-color: $color-success;

    &:focus {
      border-color: $color-success;
      outline: none;
    }

    &:hover:not(:disabled) {
      border-color: $color-success-hover;
    }
  }

  // ============================================================================
  // Shapes & Layout
  // ============================================================================

  &--rounded {
    border-radius: 4px;
  }

  &--rounded-big {
    border-radius: 100px;
  }

  &--block {
    width: 100%;
    display: block;
  }

  // ============================================================================
  // Variants
  // ============================================================================

  // Filled variant
  &--filled {
    background-color: $color-bg-gray;
    border-color: transparent;

    &:hover:not(:disabled):not(:focus) {
      background-color: color.adjust($color-bg-gray, $lightness: -3%);
    }

    &:focus {
      background-color: $color-white;
      border-color: $color-primary;
    }
  }

  // Borderless variant (underline only)
  &--borderless {
    border: none;
    border-bottom: 1px solid $color-border-base;
    border-radius: 0;
    padding-left: 0;
    padding-right: 0;

    &:focus {
      border-bottom-color: $color-primary;
      box-shadow: 0 1px 0 0 rgba($color-primary, 0.2);
    }

    &:hover:not(:disabled):not(:focus) {
      border-bottom-color: $color-primary-hover;
    }
  }

  // ============================================================================
  // Textarea specific
  // ============================================================================

  &[rows] {
    height: auto;
    min-height: 64px;
    padding: 8px 12px;
    line-height: 1.5;
    resize: vertical;

    &.av-input--small {
      min-height: 48px;
      padding: 4px 8px;
    }

    &.av-input--large {
      min-height: 80px;
      padding: 12px 16px;
    }

    &.av-input--x-large {
      min-height: 96px;
      padding: 16px 20px;
    }
  }

  // ============================================================================
  // Dark Theme
  // ============================================================================

  @include dark-theme {
    color: $dark-text-primary;
    background-color: $dark-bg-light;
    border-color: $dark-border-base;

    &::placeholder {
      color: $dark-text-tertiary;
    }

    &:focus {
      border-color: $color-primary;
      background-color: $dark-bg-light;
    }

    &:hover:not(:disabled):not(:focus) {
      border-color: color.adjust($dark-border-base, $lightness: 10%);
    }

    &:disabled,
    &--disabled {
      background-color: $dark-bg-base;
      border-color: $dark-border-base;
      color: $dark-text-tertiary;
    }

    &:read-only {
      background-color: $dark-bg-base;
    }

    // Filled variant in dark theme
    &--filled {
      background-color: $dark-bg-base;

      &:hover:not(:disabled):not(:focus) {
        background-color: color.adjust($dark-bg-base, $lightness: 3%);
      }

      &:focus {
        background-color: $dark-bg-gray;
      }
    }

    // Borderless variant in dark theme
    &--borderless {
      border-bottom-color: $dark-border-base;

      &:focus {
        border-bottom-color: $color-primary;
      }

      &:hover:not(:disabled):not(:focus) {
        border-bottom-color: color.adjust($dark-border-base, $lightness: 10%);
      }
    }
  }
}

// ============================================================================
// Input Group (для prefix/suffix)
// ============================================================================

.av-input-group {
  display: inline-flex;
  width: 100%;
  position: relative;

  &__prefix,
  &__suffix {
    display: inline-flex;
    align-items: center;
    padding: 0 12px;
    background-color: $color-bg-gray;
    border: 1px solid $color-border-base;
    color: $color-text-secondary;
    font-size: $font-size-base;
    white-space: nowrap;
    transition: all $transition-base;
  }

  &__prefix {
    border-right: none;
    border-radius: $border-radius-base 0 0 $border-radius-base;
  }

  &__suffix {
    border-left: none;
    border-radius: 0 $border-radius-base $border-radius-base 0;
  }

  // Input в группе
  .av-input {
    flex: 1;

    &:not(:first-child) {
      border-top-left-radius: 0;
      border-bottom-left-radius: 0;
    }

    &:not(:last-child) {
      border-top-right-radius: 0;
      border-bottom-right-radius: 0;
    }
  }

  // Dark theme для группы
  @include dark-theme {
    .av-input-group__prefix,
    .av-input-group__suffix {
      background-color: $dark-bg-base;
      border-color: $dark-border-base;
      color: $dark-text-tertiary;
    }
  }
}

// ============================================================================
// Input Wrapper (для label, hint, error)
// ============================================================================

.av-input-wrapper {
  display: block;
  margin-bottom: $spacing-md;

  &--block {
    width: 100%;
  }

  &__label {
    display: block;
    margin-bottom: $spacing-xs;
    font-size: $font-size-base;
    font-weight: 500;
    color: $color-text-primary;
    line-height: 1.5;

    &--required::after {
      content: " *";
      color: $color-error;
    }
  }

  &__hint {
    display: block;
    margin-top: $spacing-xs;
    font-size: $font-size-sm;
    color: $color-text-secondary;
    line-height: 1.5;
  }

  &__error {
    display: block;
    margin-top: $spacing-xs;
    font-size: $font-size-sm;
    color: $color-error;
    line-height: 1.5;
  }

  // Dark theme
  @include dark-theme {
    .av-input-wrapper__label {
      color: $dark-text-primary;
    }

    .av-input-wrapper__hint {
      color: $dark-text-tertiary;
    }
  }
}

// ============================================================================
// Accessibility
// ============================================================================

// Keyboard focus - outline уже обрабатывается через border-color в :focus
// .av-input:focus-visible {
//   outline: 2px solid $color-primary;
//   outline-offset: 2px;
// }

// Prefers reduced motion
@media (prefers-reduced-motion: reduce) {
  .av-input,
  .av-input-group__prefix,
  .av-input-group__suffix {
    transition: none;
  }
}

// ============================================================================
// Special Input Types
// ============================================================================

// Number input - скрыть стрелки
input[type="number"].av-input {
  &::-webkit-inner-spin-button,
  &::-webkit-outer-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }

  appearance: textfield;
  -moz-appearance: textfield;
}

// Search input
input[type="search"].av-input {
  &::-webkit-search-decoration,
  &::-webkit-search-cancel-button,
  &::-webkit-search-results-button,
  &::-webkit-search-results-decoration {
    -webkit-appearance: none;
  }
}

// File input
input[type="file"].av-input {
  padding: 4px 8px;
  cursor: pointer;

  &::file-selector-button {
    margin-right: 12px;
    padding: 4px 12px;
    background-color: $color-bg-gray;
    border: 1px solid $color-border-base;
    border-radius: $border-radius-sm;
    cursor: pointer;
    transition: all $transition-base;

    &:hover {
      background-color: color.adjust($color-bg-gray, $lightness: -5%);
    }
  }
}
