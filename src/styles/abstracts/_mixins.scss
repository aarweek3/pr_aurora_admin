// =============================================================================
// SCSS MIXINS
// Reusable utilities для Aurora Admin Panel
// =============================================================================

@use "./variables" as *;

// =============================================================================
// 1. RESPONSIVE / MEDIA QUERIES
// =============================================================================

/// Media query для min-width breakpoint
/// @param {String} $breakpoint - Название breakpoint (xs, sm, md, lg, xl, xxl)
/// @example
///   @include media-up(md) { width: 50%; }
@mixin media-up($breakpoint) {
  $value: map-get($breakpoints, $breakpoint);
  @if $value {
    @media (min-width: $value) {
      @content;
    }
  } @else {
    @warn "Breakpoint `#{$breakpoint}` not found in $breakpoints map.";
  }
}

/// Media query для max-width breakpoint
/// @param {String} $breakpoint - Название breakpoint
/// @example
///   @include media-down(md) { display: none; }
@mixin media-down($breakpoint) {
  $value: map-get($breakpoints, $breakpoint);
  @if $value {
    @media (max-width: ($value - 1px)) {
      @content;
    }
  } @else {
    @warn "Breakpoint `#{$breakpoint}` not found in $breakpoints map.";
  }
}

/// Media query для range между двумя breakpoints
/// @param {String} $min - Минимальный breakpoint
/// @param {String} $max - Максимальный breakpoint
/// @example
///   @include media-between(sm, lg) { padding: 20px; }
@mixin media-between($min, $max) {
  $min-value: map-get($breakpoints, $min);
  $max-value: map-get($breakpoints, $max);
  @if $min-value and $max-value {
    @media (min-width: $min-value) and (max-width: ($max-value - 1px)) {
      @content;
    }
  } @else {
    @warn "One or both breakpoints not found in $breakpoints map.";
  }
}

// =============================================================================
// 2. FLEXBOX HELPERS
// =============================================================================

/// Flexbox container с выравниванием по центру
/// @example
///   @include flex-center;
@mixin flex-center {
  display: flex;
  align-items: center;
  justify-content: center;
}

/// Flexbox container с кастомным выравниванием
/// @param {String} $align - align-items value
/// @param {String} $justify - justify-content value
/// @example
///   @include flex-layout(flex-start, space-between);
@mixin flex-layout($align: center, $justify: flex-start) {
  display: flex;
  align-items: $align;
  justify-content: $justify;
}

/// Flexbox column layout
/// @param {String} $align - align-items value
/// @param {String} $justify - justify-content value
@mixin flex-column($align: stretch, $justify: flex-start) {
  display: flex;
  flex-direction: column;
  align-items: $align;
  justify-content: $justify;
}

/// Flex item с grow/shrink/basis
/// @param {Number} $grow - flex-grow
/// @param {Number} $shrink - flex-shrink
/// @param {String} $basis - flex-basis
@mixin flex-item($grow: 0, $shrink: 1, $basis: auto) {
  flex: $grow $shrink $basis;
}

// =============================================================================
// 3. TEXT UTILITIES
// =============================================================================

/// Обрезка текста с ellipsis
/// @example
///   @include truncate;
@mixin truncate {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/// Многострочная обрезка текста
/// @param {Number} $lines - Количество строк
/// @example
///   @include line-clamp(3);
@mixin line-clamp($lines: 2) {
  display: -webkit-box;
  -webkit-line-clamp: $lines;
  -webkit-box-orient: vertical;
  overflow: hidden;
  text-overflow: ellipsis;
}

/// Запрет переноса слов
@mixin no-wrap {
  white-space: nowrap;
}

/// Перенос длинных слов
@mixin word-wrap {
  overflow-wrap: break-word;
  word-wrap: break-word;
  word-break: break-word;
}

// =============================================================================
// 4. POSITIONING
// =============================================================================

/// Absolute positioning с top/right/bottom/left
/// @param {String} $top - top value
/// @param {String} $right - right value
/// @param {String} $bottom - bottom value
/// @param {String} $left - left value
@mixin absolute($top: auto, $right: auto, $bottom: auto, $left: auto) {
  position: absolute;
  top: $top;
  right: $right;
  bottom: $bottom;
  left: $left;
}

/// Fixed positioning
@mixin fixed($top: auto, $right: auto, $bottom: auto, $left: auto) {
  position: fixed;
  top: $top;
  right: $right;
  bottom: $bottom;
  left: $left;
}

/// Полное покрытие родителя (absolute)
@mixin cover {
  @include absolute(0, 0, 0, 0);
}

/// Центрирование absolute элемента
@mixin center-absolute {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
}

// =============================================================================
// 5. VISIBILITY & DISPLAY
// =============================================================================

/// Скрыть элемент визуально, но оставить для screen readers
@mixin visually-hidden {
  position: absolute !important;
  width: 1px !important;
  height: 1px !important;
  padding: 0 !important;
  margin: -1px !important;
  overflow: hidden !important;
  clip: rect(0, 0, 0, 0) !important;
  white-space: nowrap !important;
  border: 0 !important;
}

/// Показать элемент (отмена visually-hidden)
@mixin visually-shown {
  position: static !important;
  width: auto !important;
  height: auto !important;
  padding: inherit !important;
  margin: inherit !important;
  overflow: visible !important;
  clip: auto !important;
  white-space: normal !important;
}

// =============================================================================
// 6. SCROLLBAR STYLING
// =============================================================================

/// Кастомный scrollbar (webkit)
/// @param {Color} $thumb-color - Цвет ползунка
/// @param {Color} $track-color - Цвет трека
/// @param {String} $width - Ширина scrollbar
@mixin custom-scrollbar($thumb-color: $color-gray-6, $track-color: $color-gray-3, $width: 8px) {
  &::-webkit-scrollbar {
    width: $width;
    height: $width;
  }

  &::-webkit-scrollbar-track {
    background: $track-color;
    border-radius: $border-radius-base;
  }

  &::-webkit-scrollbar-thumb {
    background: $thumb-color;
    border-radius: $border-radius-base;

    &:hover {
      background: darken($thumb-color, 10%);
    }
  }
}

/// Скрыть scrollbar (но оставить прокрутку)
@mixin hide-scrollbar {
  scrollbar-width: none; /* Firefox */
  -ms-overflow-style: none; /* IE/Edge */

  &::-webkit-scrollbar {
    display: none; /* Chrome/Safari */
  }
}

// =============================================================================
// 7. TRANSITIONS & ANIMATIONS
// =============================================================================

/// Transition для одного или нескольких свойств
/// @param {List} $properties - Список свойств
/// @param {Time} $duration - Длительность
/// @param {String} $timing - Timing function
@mixin transition(
  $properties,
  $duration: $transition-duration-base,
  $timing: $transition-timing-ease-in-out
) {
  $transitions: ();
  @each $property in $properties {
    $transitions: append($transitions, $property $duration $timing, comma);
  }
  transition: $transitions;
}

/// Fade-in animation
@mixin fade-in($duration: $transition-duration-base) {
  animation: fadeIn $duration $transition-timing-ease-in-out;
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

/// Slide-in from top
@mixin slide-in-top($duration: $transition-duration-base) {
  animation: slideInTop $duration $transition-timing-ease-out;
}

@keyframes slideInTop {
  from {
    transform: translateY(-20px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

// =============================================================================
// 8. RESET & NORMALIZE
// =============================================================================

/// Убрать стандартные стили списка
@mixin reset-list {
  margin: 0;
  padding: 0;
  list-style: none;
}

/// Убрать стандартные стили кнопки
@mixin reset-button {
  padding: 0;
  margin: 0;
  border: none;
  background: none;
  font: inherit;
  color: inherit;
  cursor: pointer;
  outline: none;

  &:focus {
    outline: none;
  }
}

/// Убрать стандартные стили input
@mixin reset-input {
  padding: 0;
  margin: 0;
  border: none;
  background: none;
  font: inherit;
  color: inherit;
  outline: none;

  &:focus {
    outline: none;
  }
}

// =============================================================================
// 9. SPACING UTILITIES
// =============================================================================

/// Генератор margin
/// @param {String} $direction - top, right, bottom, left, all
/// @param {Number} $size - Размер из $spacings map
@mixin margin($direction, $size) {
  $value: map-get($spacings, $size);
  @if $direction == "all" {
    margin: $value;
  } @else {
    margin-#{$direction}: $value;
  }
}

/// Генератор padding
/// @param {String} $direction - top, right, bottom, left, all
/// @param {Number} $size - Размер из $spacings map
@mixin padding($direction, $size) {
  $value: map-get($spacings, $size);
  @if $direction == "all" {
    padding: $value;
  } @else {
    padding-#{$direction}: $value;
  }
}

// =============================================================================
// 10. COMPONENT SPECIFIC MIXINS
// =============================================================================

/// Button hover effect
@mixin button-hover-effect {
  transition: $transition-base;

  &:hover:not(:disabled) {
    transform: translateY(-1px);
    box-shadow: $shadow-md;
  }

  &:active:not(:disabled) {
    transform: translateY(0);
    box-shadow: $shadow-sm;
  }
}

/// Card elevation
@mixin card-elevation($level: 1) {
  @if $level == 1 {
    box-shadow: $shadow-sm;
  } @else if $level == 2 {
    box-shadow: $shadow-base;
  } @else if $level == 3 {
    box-shadow: $shadow-md;
  } @else if $level == 4 {
    box-shadow: $shadow-lg;
  } @else {
    box-shadow: $shadow-xl;
  }

  &:hover {
    @if $level == 1 {
      box-shadow: $shadow-base;
    } @else if $level == 2 {
      box-shadow: $shadow-md;
    } @else if $level == 3 {
      box-shadow: $shadow-lg;
    } @else {
      box-shadow: $shadow-xl;
    }
  }
}

/// Focus ring (для accessibility)
@mixin focus-ring($color: $color-primary) {
  outline: 2px solid $color;
  outline-offset: 2px;
}

// =============================================================================
// 11. DARK THEME MIXIN
// =============================================================================

/// Применить стили для dark theme
/// ВАЖНО: Используйте ТОЛЬКО внутри селектора, не на верхнем уровне!
/// @example
///   .button {
///     background: white;
///
///     @include dark-theme {
///       background: black;
///     }
///   }
@mixin dark-theme {
  :global([data-theme="dark"]) & {
    @content;
  }
}
