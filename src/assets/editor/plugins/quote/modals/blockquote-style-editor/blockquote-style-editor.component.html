<dialog #dialog class="blockquote-style-editor-modal">
  <div class="modal-container">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
    <div class="modal-header">
      <h2>{{ isEditMode ? '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∏–ª—å' : '–°–æ–∑–¥–∞—Ç—å —Å—Ç–∏–ª—å' }}</h2>
      <button class="close-btn" type="button" (click)="cancel()" title="–ó–∞–∫—Ä—ã—Ç—å">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>

    <!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
    <div class="messages" *ngIf="errorMessage || successMessage">
      <div class="error-message" *ngIf="errorMessage">
        {{ errorMessage }}
      </div>
      <div class="success-message" *ngIf="successMessage">
        {{ successMessage }}
      </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç (2 –∫–æ–ª–æ–Ω–∫–∏) -->
    <div class="modal-body">
      <!-- –õ–ï–í–ê–Ø –ü–ê–ù–ï–õ–¨: LIVE PREVIEW -->
      <div class="preview-panel">
        <h3>–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä</h3>
        <div class="preview-container">
          <blockquote class="preview-blockquote" [ngStyle]="getPreviewQuoteStyles()">
            <!-- Before —ç–ª–µ–º–µ–Ω—Ç -->
            <span
              *ngIf="showBeforeElement"
              class="preview-before"
              [ngStyle]="getPreviewBeforeStyles()"
            >
              {{ quoteStyles.beforeContent }}
            </span>

            <p class="preview-text">{{ previewText }}</p>

            <footer class="preview-footer" [ngStyle]="getPreviewFooterStyles()">
              ‚Äî <cite>{{ previewSource }}</cite>, {{ previewAuthor }}
            </footer>
          </blockquote>
        </div>
      </div>

      <!-- –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨: –ù–ê–°–¢–†–û–ô–ö–ò -->
      <div class="settings-panel">
        <!-- –ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–∏–ª—è -->
        <div class="form-group">
          <label for="styleName">–ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–∏–ª—è *</label>
          <input
            type="text"
            id="styleName"
            [(ngModel)]="styleName"
            placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ú–æ–π –∫—Ä–∞—Å–∏–≤—ã–π —Å—Ç–∏–ª—å"
            required
            [disabled]="isLoading"
          />
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∏ -->
        <div class="tabs">
          <button
            type="button"
            class="tab-btn"
            [class.active]="activeTab === 'quote'"
            (click)="switchTab('quote')"
          >
            –¶–∏—Ç–∞—Ç–∞
          </button>
          <button
            type="button"
            class="tab-btn"
            [class.active]="activeTab === 'footer'"
            (click)="switchTab('footer')"
          >
            –ü–æ–¥–ø–∏—Å—å
          </button>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ "–¶–∏—Ç–∞—Ç–∞" -->
        <div class="tab-content" *ngIf="activeTab === 'quote'">
          <div class="settings-grid">
            <!-- –§–æ–Ω -->
            <div class="form-group">
              <label for="backgroundColor">–¶–≤–µ—Ç —Ñ–æ–Ω–∞</label>
              <input
                type="color"
                id="backgroundColor"
                [(ngModel)]="quoteStyles.backgroundColor"
                [disabled]="isLoading"
              />
              <input
                type="text"
                [(ngModel)]="quoteStyles.backgroundColor"
                placeholder="#f9f9f9"
                [disabled]="isLoading"
              />
            </div>

            <!-- –¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞ -->
            <div class="form-group">
              <label for="color">–¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞</label>
              <input
                type="color"
                id="color"
                [(ngModel)]="quoteStyles.color"
                [disabled]="isLoading"
              />
              <input
                type="text"
                [(ngModel)]="quoteStyles.color"
                placeholder="#555"
                [disabled]="isLoading"
              />
            </div>

            <!-- –¶–≤–µ—Ç –≥—Ä–∞–Ω–∏—Ü—ã -->
            <div class="form-group">
              <label for="borderColor">–¶–≤–µ—Ç –≥—Ä–∞–Ω–∏—Ü—ã</label>
              <input
                type="color"
                id="borderColor"
                [(ngModel)]="quoteStyles.borderColor"
                [disabled]="isLoading"
              />
              <input
                type="text"
                [(ngModel)]="quoteStyles.borderColor"
                placeholder="#ccc"
                [disabled]="isLoading"
              />
            </div>

            <!-- –¢–æ–ª—â–∏–Ω–∞ –≥—Ä–∞–Ω–∏—Ü—ã -->
            <div class="form-group">
              <label for="borderWidth">–¢–æ–ª—â–∏–Ω–∞ –≥—Ä–∞–Ω–∏—Ü—ã</label>
              <input
                type="text"
                id="borderWidth"
                [(ngModel)]="quoteStyles.borderWidth"
                placeholder="0 0 0 4px"
                [disabled]="isLoading"
              />
            </div>

            <!-- –°—Ç–∏–ª—å –≥—Ä–∞–Ω–∏—Ü—ã -->
            <div class="form-group">
              <label for="borderStyle">–°—Ç–∏–ª—å –≥—Ä–∞–Ω–∏—Ü—ã</label>
              <select id="borderStyle" [(ngModel)]="quoteStyles.borderStyle" [disabled]="isLoading">
                <option value="solid">–°–ø–ª–æ—à–Ω–∞—è</option>
                <option value="dashed">–ü—É–Ω–∫—Ç–∏—Ä–Ω–∞—è</option>
                <option value="dotted">–¢–æ—á–µ—á–Ω–∞—è</option>
                <option value="double">–î–≤–æ–π–Ω–∞—è</option>
              </select>
            </div>

            <!-- –°–∫—Ä—É–≥–ª–µ–Ω–∏–µ —É–≥–ª–æ–≤ -->
            <div class="form-group">
              <label for="borderRadius">–°–∫—Ä—É–≥–ª–µ–Ω–∏–µ —É–≥–ª–æ–≤</label>
              <input
                type="text"
                id="borderRadius"
                [(ngModel)]="quoteStyles.borderRadius"
                placeholder="0 –∏–ª–∏ 8px"
                [disabled]="isLoading"
              />
            </div>

            <!-- –û—Ç—Å—Ç—É–ø—ã –≤–Ω—É—Ç—Ä–∏ -->
            <div class="form-group">
              <label for="padding">–û—Ç—Å—Ç—É–ø—ã (padding)</label>
              <input
                type="text"
                id="padding"
                [(ngModel)]="quoteStyles.padding"
                placeholder="1em 1.5em"
                [disabled]="isLoading"
              />
            </div>

            <!-- –û—Ç—Å—Ç—É–ø—ã —Å–Ω–∞—Ä—É–∂–∏ -->
            <div class="form-group">
              <label for="margin">–û—Ç—Å—Ç—É–ø—ã (margin)</label>
              <input
                type="text"
                id="margin"
                [(ngModel)]="quoteStyles.margin"
                placeholder="1.5em 0"
                [disabled]="isLoading"
              />
            </div>

            <!-- –°—Ç–∏–ª—å —à—Ä–∏—Ñ—Ç–∞ -->
            <div class="form-group">
              <label for="fontStyle">–°—Ç–∏–ª—å —à—Ä–∏—Ñ—Ç–∞</label>
              <select id="fontStyle" [(ngModel)]="quoteStyles.fontStyle" [disabled]="isLoading">
                <option value="normal">–û–±—ã—á–Ω—ã–π</option>
                <option value="italic">–ö—É—Ä—Å–∏–≤</option>
              </select>
            </div>

            <!-- –†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ -->
            <div class="form-group">
              <label for="fontSize">–†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞</label>
              <input
                type="text"
                id="fontSize"
                [(ngModel)]="quoteStyles.fontSize"
                placeholder="1em"
                [disabled]="isLoading"
              />
            </div>

            <!-- –í—ã—Å–æ—Ç–∞ —Å—Ç—Ä–æ–∫–∏ -->
            <div class="form-group">
              <label for="lineHeight">–í—ã—Å–æ—Ç–∞ —Å—Ç—Ä–æ–∫–∏</label>
              <input
                type="text"
                id="lineHeight"
                [(ngModel)]="quoteStyles.lineHeight"
                placeholder="1.6"
                [disabled]="isLoading"
              />
            </div>

            <!-- –¢–µ–Ω—å -->
            <div class="form-group">
              <label for="boxShadow">–¢–µ–Ω—å (box-shadow)</label>
              <input
                type="text"
                id="boxShadow"
                [(ngModel)]="quoteStyles.boxShadow"
                placeholder="none –∏–ª–∏ 0 2px 8px rgba(0,0,0,0.1)"
                [disabled]="isLoading"
              />
            </div>

            <!-- –ö–∞–≤—ã—á–∫–∏ (before) -->
            <div class="form-group full-width">
              <h4>–ö–∞–≤—ã—á–∫–∏ / –ò–∫–æ–Ω–∫–∞</h4>
            </div>

            <div class="form-group">
              <label for="beforeContent">–°–∏–º–≤–æ–ª</label>
              <input
                type="text"
                id="beforeContent"
                [(ngModel)]="quoteStyles.beforeContent"
                placeholder='" –∏–ª–∏ üí¨'
                [disabled]="isLoading"
              />
            </div>

            <div class="form-group">
              <label for="beforeFontSize">–†–∞–∑–º–µ—Ä</label>
              <input
                type="text"
                id="beforeFontSize"
                [(ngModel)]="quoteStyles.beforeFontSize"
                placeholder="3em"
                [disabled]="isLoading"
              />
            </div>

            <div class="form-group">
              <label for="beforeColor">–¶–≤–µ—Ç</label>
              <input
                type="color"
                id="beforeColor"
                [(ngModel)]="quoteStyles.beforeColor"
                [disabled]="isLoading"
              />
            </div>

            <div class="form-group">
              <label for="beforeOpacity">–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å</label>
              <input
                type="text"
                id="beforeOpacity"
                [(ngModel)]="quoteStyles.beforeOpacity"
                placeholder="0.3"
                [disabled]="isLoading"
              />
            </div>

            <div class="form-group">
              <label for="beforeLeft">–ü–æ–∑–∏—Ü–∏—è Left</label>
              <input
                type="text"
                id="beforeLeft"
                [(ngModel)]="quoteStyles.beforePosition!.left"
                placeholder="-0.4em"
                [disabled]="isLoading"
              />
            </div>

            <div class="form-group">
              <label for="beforeTop">–ü–æ–∑–∏—Ü–∏—è Top</label>
              <input
                type="text"
                id="beforeTop"
                [(ngModel)]="quoteStyles.beforePosition!.top"
                placeholder="-0.2em"
                [disabled]="isLoading"
              />
            </div>
          </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ "–ü–æ–¥–ø–∏—Å—å" -->
        <div class="tab-content" *ngIf="activeTab === 'footer'">
          <div class="settings-grid">
            <div class="form-group">
              <label for="footerFontSize">–†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞</label>
              <input
                type="text"
                id="footerFontSize"
                [(ngModel)]="footerStyles.fontSize"
                placeholder="0.9em"
                [disabled]="isLoading"
              />
            </div>

            <div class="form-group">
              <label for="footerColor">–¶–≤–µ—Ç</label>
              <input
                type="color"
                id="footerColor"
                [(ngModel)]="footerStyles.color"
                [disabled]="isLoading"
              />
              <input
                type="text"
                [(ngModel)]="footerStyles.color"
                placeholder="#666"
                [disabled]="isLoading"
              />
            </div>

            <div class="form-group">
              <label for="footerFontStyle">–°—Ç–∏–ª—å —à—Ä–∏—Ñ—Ç–∞</label>
              <select id="footerFontStyle" [(ngModel)]="footerStyles.fontStyle" [disabled]="isLoading">
                <option value="normal">–û–±—ã—á–Ω—ã–π</option>
                <option value="italic">–ö—É—Ä—Å–∏–≤</option>
              </select>
            </div>

            <div class="form-group">
              <label for="footerFontWeight">–¢–æ–ª—â–∏–Ω–∞ —à—Ä–∏—Ñ—Ç–∞</label>
              <select id="footerFontWeight" [(ngModel)]="footerStyles.fontWeight" [disabled]="isLoading">
                <option value="normal">Normal (400)</option>
                <option value="500">Medium (500)</option>
                <option value="600">Semibold (600)</option>
                <option value="bold">Bold (700)</option>
              </select>
            </div>

            <div class="form-group">
              <label for="footerTextAlign">–í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ</label>
              <select id="footerTextAlign" [(ngModel)]="footerStyles.textAlign" [disabled]="isLoading">
                <option value="left">–°–ª–µ–≤–∞</option>
                <option value="center">–ü–æ —Ü–µ–Ω—Ç—Ä—É</option>
                <option value="right">–°–ø—Ä–∞–≤–∞</option>
              </select>
            </div>

            <div class="form-group">
              <label for="footerMarginTop">–û—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É</label>
              <input
                type="text"
                id="footerMarginTop"
                [(ngModel)]="footerStyles.marginTop"
                placeholder="1em"
                [disabled]="isLoading"
              />
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- –§—É—Ç–µ—Ä -->
    <div class="modal-footer">
      <button class="btn btn-secondary" type="button" (click)="cancel()" [disabled]="isLoading">
        –û—Ç–º–µ–Ω–∞
      </button>
      <button class="btn btn-primary" type="button" (click)="save()" [disabled]="isLoading">
        {{ isEditMode ? '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å' : '–°–æ–∑–¥–∞—Ç—å' }}
      </button>
    </div>

    <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div class="loading-overlay" *ngIf="isLoading">
      <div class="spinner"></div>
    </div>
  </div>
</dialog>
